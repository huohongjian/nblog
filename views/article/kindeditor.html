<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="description" content="China FreeBSD">
	<meta name="keywords" content="China FreeBSD nBLOG nWIKI nCMS" />
	<meta name="author" content="China FreeBSD">
	<meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
	<title>KindEditor</title>
	<link rel="stylesheet" href="{{ baseURL }}/css/font-awesome-4.7.0/css/font-awesome.min.css">
	<link rel="stylesheet" href="{{ baseURL }}/own/R.css">
	<link rel="stylesheet" href="{{ baseURL }}/css/nblog.css">
	<link rel="stylesheet" href="{{ baseURL }}/js/kindeditor/themes/default/default.css" />
	<link rel="stylesheet" href="{{ baseURL }}/js/kindeditor/plugins/code/prettify.css" />
	<style>
		html, body {margin: 0;}

		
		input[name=title],
		input[name=alias],
		input[name=caption],
		textarea {width:100%; margin-bottom: 8px;}
		textarea[name=caption] {height: 60px;}
		input[name=articleid] {display: none;}
		input[name=publish] {width:10px;}
		input[name=save] {float: right;}
		select {width:80px;}
		
		.left-frame > form,
		.right-frame > div {margin: 10px;}

		.banner {padding: 10px; background: #990000; #438eb9;}
		.banner * { color: #ffffff; }
		.banner .title {font-weight: bolder; display: inline-block; text-align: center;}

		.ke-button { color:#555555; padding:2px 10px; margin:0; }

	</style>
	
		
		
	<script>
		
	</script>
</head>
<body>
	<div class="banner">
		<span class="a-1-1 d-1-4 f-1-5 title">添加/修改文章</span>
		<span><a href="{{ baseURL }}/"><i class="fa fa-home"> 首页</i></a></span>
	</div>
	
	<div class="flex">
		<div class="a-1-1 d-1-4 f-1-5 left-frame">
			<form id="editForm">
				<input type="text" name="articleid" value="{{ article.articleid }}">
				<label>标题：<input name="title" type="text" value="{{ article.title }}"></label>
				<label>别名：<input name="alias" type="text" value="{{ article.alias }}"></label>
				<label>摘要：<textarea name="caption">{{ article.abstract }}</textarea></label>
				
				<!-- <label>微缩图：</label>
				<textarea name="caption"></textarea> -->

				<label>类别：</label>
				<select name="categoryid">
					<option value="1">综合</option>
				</select>

				<label>发表：</label>
				<label><input type="radio" name="publish" value="1" checked="{{ article.publish }}">是</label>
				<label><input type="radio" name="publish" value="0">否</label>
				
				<input type="button" name="save" value="保存" />

			</form>
		</div>

		<div class="a-1-1 d-3-4 f-4-5 right-frame">
			<div>
				<textarea name="content" style="width:100%; height:560px; visibility:hidden;">
					{{ article.content }}
				</textarea>
			</div>
		</div>	
	</div>



<script src="{{ baseURL }}/js/kindeditor/kindeditor-all-min.js"></script>
<script src="{{ baseURL }}/js/kindeditor/plugins/code/prettify.js"></script>
<script src="{{ baseURL }}/own/R.js"></script>
<script src="{{ baseURL }}/own/Panel.js"></script>
<script type="text/javascript">
	var editor;
	KindEditor.ready(function(K) {
		editor = K.create('textarea[name="content"]', {
//			cssPath : 			'../../../js/kindeditor/plugins/code/prettify.css',
			uploadJson : 		'../../../js/kindeditor/php/upload_json.php',
			fileManagerJson : 	'../../../js/kindeditor/php/file_manager_json.php',
			allowFileManager : true,
			cssData: 'body {font-family:"微软雅黑"; font-size:18px;}',
		});
//		prettyPrint();
		K('input[name=save]').click(save);
	});









	R.enterMove();
	var articleid = R('[name="articleid"]').value;

	function save() {

		R.post("../save", R.fd('#editForm',{
	//		image: R.id('thumb').src.match(/\/images.*/),
			content: editor.html(),
			articleid: articleid,
		}), function(r){
			if (r.status == 200) {
				articleid = r.articleid;
				panelMsg(articleid);
				
			}
	//		message(r.msg, 1000);
		}, 'JSON');


	}
</script>
</body>
</html>
