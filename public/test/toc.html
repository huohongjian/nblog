<html>
 <head>
  <title>使用HTML的锚点链接定位到具体的内容</title>
 <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />


<style type="text/css">
    

    /*生成博客目录的CSS*/
#sideBar{
    font-size:12px;
    font-family:Arial, Helvetica, sans-serif;
    text-align:left;
    position:fixed;/*将div的位置固定到距离top:50px，right:0px的位置，这样div就会处在最右边的位置，距离顶部50px*/
    top:50px;
    right:0px;
    width: auto;
    height: auto; 
}
#sideBarTab{
    float:left;
    width:30px; 
    border:1px solid #e5e5e5;
    border-right:none;
    text-align:center;
    background:#ffffff;
}

#sideBarContents{
    float:left;
    overflow:auto; 
    overflow-x:hidden;!important;
    width:200px;
    min-height:108px;
    max-height:460px;
    border:1px solid #e5e5e5;
    border-right:none; 
    background:#ffffff;
}
#sideBarContents dl{
    margin:0;
    padding:0;
}

#sideBarContents dt{
    margin-top:5px;
    margin-left:5px;
}

#sideBarContents dd, dt {
    cursor: pointer;
}

#sideBarContents dd:hover, dt:hover {
    color:#A7995A;
}
</style>


 </head>
 <body id="cnblogs_post_body">
    <a href="http://www.cnblogs.com/dingzk/p/4682833.html">本文链接</a>
    <h1>目录导航</h1>
    <dl>
        <!--设置锚点：<a href="#title0">一、JAVA流式输入/输出原理</a>
        点击这个超链接时就会自动定位到<h2 id="title0" name="title0">一、JAVA流式输入/输出原理</h2>这个标题所在的位置
        -->
        <dt><a href="#title0">一、JAVA流式输入/输出原理</a></dt>
        <dt><a href="#title1">二、输入输出流分类</a></dt>
        <dt><a href="#title2">三、节点流和处理流</a></dt>
            <dd><a href="#title3">3.1.节点流类型</a></dd>
            <dd><a href="#title4">3.2.处理流类型</a></dd>
        <dt><a href="#title5">四、InputStream(输入流)</a></dt>
            <dd><a href="#title6">4.1.InputStream的基本方法</a></dd>
        <dt><a href="#title7">五、OutputStream(输出流)</a></dt>
            <dd><a href="#title8">5.1.OutputStream的基本方法</a></dd>
        <dt><a href="#title9">六、Reader流</a></dt>
            <dd><a href="#title10">6.1.Reader的基本方法</a></dd>
        <dt><a href="#title11">七、Writer流</a></dt>
            <dd><a href="#title12">7.1.Writer的基本方法</a></dd>
        <dt><a href="#title13">八、节点流讲解</a></dt>
        <dt><a href="#title14">九、处理流讲解</a></dt>
            <dd><a href="#title15">9.1.第一种处理流——缓冲流(Buffering)</a></dd>
            <dd><a href="#title16">9.2.第二种处理流——转换流</a></dd>
            <dd><a href="#title17">9.3.第三种处理流——数据流</a></dd>
            <dd><a href="#title18">9.4.打印流——Print</a></dd>
            <dd><a href="#title19">9.5. 对象流——Object</a></dd>
        <dt><a href="#title20">十、IO流总结</a></dt>
    </dl> 
    <hr/>
    <div style=" width:100%;height:150px;">
        <!--经过测试发现，使用name的形式添加锚点在IE8和火狐下都不起作用，要设置Id才起作用
        为了兼容，还是将name属性和id属性都一起写上，并且属性值设置成相同
        -->
        <h2 id="title0" name="title0">一、JAVA流式输入/输出原理JAVA流式输入/输出原理JAVA流式输入/输出原理JAVA流式输入/输出原理</h2>
    </div>
    <div style=" width:100%;height:150px;">
        <h2 name="title1" id="title1">二、输入输出流分类</h2>
        <h2 name="title1" id="title1">二、输入输出流分类</h2>
    </div>
    <div style=" width:100%;height:150px;">
        <h2 name="title2" id="title2">三、节点流和处理流</h2>
        <h3 name="title3" id="title3">3.1.节点流类型</h3>
        <h3 name="title4" id="title4">3.2.处理流类型</h3>
    </div>
    <div style=" width:100%;height:150px;">
        <h2 name="title5" id="title5">四、InputStream(输入流)</h2>
        <h3 name="title6" id="title6">4.1.InputStream的基本方法</h3>
    </div>
    <div style=" width:100%;height:150px;">
        <h2 name="title7" id="title7">五、OutputStream(输出流)</h2>
        <h3 name="title8" id="title8">5.1.OutputStream的基本方法</h3>
    </div>
    <div style=" width:100%;height:150px;">
        <h2 name="title9" id="title9">六、Reader流</h2>
        <h3 name="title10" id="title10">6.1.Reader的基本方法</h3>
    </div>
    <div style=" width:100%;height:150px;">
        <h2 name="title11" id="title11">七、Writer流</h2>
        <h3 name="title12" id="title12">7.1.Writer的基本方法</h3>
    </div>
    <div style=" width:100%;height:150px;">
        <h2 name="title13" id="title13">八、节点流讲解</h2>
    </div>
    <div style=" width:100%;height:150px;">
        <h2 name="title14" id="title14">九、处理流讲解</h2>
        <h3 name="title15" id="title15">9.1.第一种处理流——缓冲流(Buffering)</h3>
        <h3 name="title16" id="title16">9.2.第二种处理流——转换流</h3>
        <h3 name="title17" id="title17">9.3.第三种处理流——数据流</h3>
        <h3 name="title18" id="title18">9.4.打印流——Print</h3>
        <h3 name="title19" id="title19">9.5. 对象流——Object</h3>
    </div>
    <div style=" width:100%;height:150px;">
        <h2 name="title20" id="title20">十、IO流总结</h2>
    </div>
    <div style="height:130px;">&nbsp;</div>
    <div style="height:130px;">&nbsp;</div>
    <div style="height:130px;">&nbsp;</div>











<script type="text/javascript">
    /*
    功能：生成博客目录的JS工具
    测试：IE8，火狐，google测试通过
    孤傲苍狼
    2014-5-11
*/
var BlogDirectory = {
    /*
        获取元素位置，距浏览器左边界的距离（left）和距浏览器上边界的距离（top）
    */
    getElementPosition:function (ele) {        
        var topPosition = 0;
        var leftPosition = 0;
        while (ele){              
            topPosition += ele.offsetTop;
            leftPosition += ele.offsetLeft;        
            ele = ele.offsetParent;     
        }  
        return {top:topPosition, left:leftPosition}; 
    },

    /*
    获取滚动条当前位置
    */
    getScrollBarPosition:function () {
        var scrollBarPosition = document.body.scrollTop || document.documentElement.scrollTop;
        return  scrollBarPosition;
    },
    
    /*
    移动滚动条，finalPos 为目的位置，internal 为移动速度
    */
    moveScrollBar:function(finalpos, interval) {

        //若不支持此方法，则退出
        if(!window.scrollTo) {
            return false;
        }

        //窗体滚动时，禁用鼠标滚轮
        window.onmousewheel = function(){
            return false;
        };
          
        //清除计时
        if (document.body.movement) { 
            clearTimeout(document.body.movement); 
        } 

        var currentpos =BlogDirectory.getScrollBarPosition();//获取滚动条当前位置

        var dist = 0; 
        if (currentpos == finalpos) {//到达预定位置，则解禁鼠标滚轮，并退出
            window.onmousewheel = function(){
                return true;
            }
            return true; 
        } 
        if (currentpos < finalpos) {//未到达，则计算下一步所要移动的距离
            dist = Math.ceil((finalpos - currentpos)/10); 
            currentpos += dist; 
        } 
        if (currentpos > finalpos) { 
            dist = Math.ceil((currentpos - finalpos)/10); 
            currentpos -= dist; 
        }
        
        var scrTop = BlogDirectory.getScrollBarPosition();//获取滚动条当前位置
        window.scrollTo(0, currentpos);//移动窗口
        if(BlogDirectory.getScrollBarPosition() == scrTop)//若已到底部，则解禁鼠标滚轮，并退出
        {
            window.onmousewheel = function(){
                return true;
            }
            return true;
        }
        
        //进行下一步移动
        var repeat = "BlogDirectory.moveScrollBar(" + finalpos + "," + interval + ")"; 
        document.body.movement = setTimeout(repeat, interval); 
    },
    
    htmlDecode:function (text){
        var temp = document.createElement("div");
        temp.innerHTML = text;
        var output = temp.innerText || temp.textContent;
        temp = null;
        return output;
    },

    /*
    创建博客目录，
    id表示包含博文正文的 div 容器的 id，
    mt 和 st 分别表示主标题和次级标题的标签名称（如 H2、H3，大写或小写都可以！），
    interval 表示移动的速度
    */
    createBlogDirectory:function (id, mt, st, interval){
         //获取博文正文div容器
        var elem = document.getElementById(id);
        if(!elem) return false;
        //获取div中所有元素结点
        var nodes = elem.getElementsByTagName("*");
        //创建博客目录的div容器
        var divSideBar = document.createElement('DIV');
        divSideBar.className = 'sideBar';
        divSideBar.setAttribute('id', 'sideBar');
        var divSideBarTab = document.createElement('DIV');
        divSideBarTab.setAttribute('id', 'sideBarTab');
        divSideBar.appendChild(divSideBarTab);
        var h2 = document.createElement('H2');
        divSideBarTab.appendChild(h2);
        var txt = document.createTextNode('目录导航');
        h2.appendChild(txt);
        var divSideBarContents = document.createElement('DIV');
        divSideBarContents.style.display = 'none';
        divSideBarContents.setAttribute('id', 'sideBarContents');
        divSideBar.appendChild(divSideBarContents);
        //创建自定义列表
        var dlist = document.createElement("dl");
        divSideBarContents.appendChild(dlist);
        var num = 0;//统计找到的mt和st
        mt = mt.toUpperCase();//转化成大写
        st = st.toUpperCase();//转化成大写
        //遍历所有元素结点
        for(var i=0; i<nodes.length; i++)
        {
            if(nodes[i].nodeName == mt|| nodes[i].nodeName == st)    
            {
                //获取标题文本
                var nodetext = nodes[i].innerHTML.replace(/<\/?[^>]+>/g,"");//innerHTML里面的内容可能有HTML标签，所以用正则表达式去除HTML的标签
                nodetext = nodetext.replace(/&nbsp;/ig, "");//替换掉所有的&nbsp;
                nodetext = BlogDirectory.htmlDecode(nodetext);
                //插入锚        
                nodes[i].setAttribute("id", "blogTitle" + num);
                var item;
                switch(nodes[i].nodeName)
                {
                    case mt:    //若为主标题 
                        item = document.createElement("dt");
                        break;
                    case st:    //若为子标题
                        item = document.createElement("dd");
                        break;
                }
                
                //创建锚链接
                var itemtext = document.createTextNode(nodetext);
                item.appendChild(itemtext);
                item.setAttribute("name", num);
                item.onclick = function(){        //添加鼠标点击触发函数
                    var pos = BlogDirectory.getElementPosition(document.getElementById("blogTitle" + this.getAttribute("name")));
                    if(!BlogDirectory.moveScrollBar(pos.top, interval)) return false;
                };            
                
                //将自定义表项加入自定义列表中
                dlist.appendChild(item);
                num++;
            }
        }
        
        if(num == 0) return false; 
        /*鼠标进入时的事件处理*/
        divSideBarTab.onmouseenter = function(){
            divSideBarContents.style.display = 'block';
        }
        /*鼠标离开时的事件处理*/
        divSideBar.onmouseleave = function() {
            divSideBarContents.style.display = 'none';
        }

        document.body.appendChild(divSideBar);
    }
    
};

window.onload=function(){
    /*页面加载完成之后生成博客目录*/
    BlogDirectory.createBlogDirectory("cnblogs_post_body","h2","h3",20);
}
</script>
 </body>
</html>